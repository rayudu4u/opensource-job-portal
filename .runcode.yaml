onCreate:
  - sudo apt-get update -y
  - sudo apt install git postgresql python3 python3-dev python3-virtualenv build-essential ruby ruby-dev gem redis-server memcached redis-tools virtualenv apt-transport-https ca-certificates curl software-properties-common gcc g++ make -y
  - |
        sudo apt-get -y install postgresql postgresql-contrib
        sudo -u postgres psql postgres -c "ALTER USER postgres PASSWORD 'root'"
        sudo -u postgres psql postgres -c "CREATE DATABASE peeljobs WITH OWNER = postgres"
  - |
        curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
        sudo apt-get install -y nodejs node-less
        sudo gem install sass
        sudo ln -s /usr/bin/lessc /usr/local/bin/lessc
  - |
        virtualenv -p python3 ../venv
        . ../venv/bin/activate
        cp ENV.md .env
        pip install -U pip
        pip install -r requirements.txt
        python manage.py migrate
onStart:
  - |
        . ../venv/bin/activate
        WS_DOMAIN=`cat /home/ubuntu/runcode/ws-url-domain.txt`
        printf "\nGO TO THIS URL TO VIEW PAGE \033[4;34m https://8000-${WS_DOMAIN}\033[0;30m\n\n"
        python manage.py runserver
